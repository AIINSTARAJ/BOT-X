{% extends 'base.html' %}

{% block title %} Chat {% endblock %}
{% block meta %} 
<meta property="og:image" content="">
<meta name="author" content="A.I Instaraj">
<meta name="description" content="Chat with BOT-X. Provision of advanced tools for natural language processing. Built with love by A.I Instaraj">
{% endblock %}
{% block content %}

    <div class="chat-container">

        <div class="chat-header"> BOT-X </div>

        <div class="chat-messages" id="chat-messages"></div>

        <input type="text" id="message-input" placeholder="Type a message...">

        <button id="send-button"> &#10148;</button>

    </div>

    <script src="{{url_for('static', filename = 'js/app.js')}}"></script>

</body>

<style>

    .chat-container {

        width: 32%;

        height: 500px;

        border: 2.5px solid;

        border-radius: 15px;

        padding: 20px;

        margin-left: 34%;

        margin-top: 60px;

        background-color: rgb(228, 197, 157);
        border-color: yellow;
        
    }

    .chat-header {

        background-color: rgb(16, 54, 221);

        padding: 10px;

        text-align: center;
        color: white;
        font-size: 15px;
        border-radius: 10px;
        border-color: yellow;

    }

    .chat-messages {

        padding: 20px;

        overflow-y: auto;

        height: 400px;
        scrollbar-color: yellow;
        scrollbar-width: 10px;

    }

    .message {

        margin-bottom: 10px;

    }

    #message-input{
            margin-left: 16%;
            width: 60%;
            padding: 4px;
            border-width: 2.5px;
            border-color: white;
            border-style: solid;
            border-radius: 5px;
            font-size: 17.5px;
            color: rgb(8, 8, 8); 
            background-color: rgb(252, 252, 252);
            font-family: sans-serif;
            font-style: italic;
        }


    #send-button{
        margin-left: 12px;
        font-size: larger;
        color: rgb(25, 209, 25);
        height: 25px;
        width: 32px;
        border-width: 2.5px;
        border-color: #d3b894;
        border-style: solid;
        border-radius: 5px;
        cursor: pointer;
    }
    .user-message {

        background-color: #6de948b6;

        padding: 10px;
        border-radius: 10px;
        margin-left: 150px;
        font-family: sans-serif;
        font-style: italic;
        font-size: 12px;
        font-display: swap;
    }

    .bot-message {

        background-color: whitesmoke;
        font-family: sans-serif;
        font-style: italic;
        color: rgb(26, 26, 27);

        padding: 10px;
        font-size: 12px;

        border-radius: 10px;
        margin-right: 160px;
        margin-top: 20px;

    }
@media only screen and (max-width: 768px) {
    /* Chat container adjustments for mobile screens */
    .chat-container {
        width: 90%; /* Full width on mobile */
        height: 450px; /* Adjust height for mobile */
        margin: 20px auto; /* Centered on screen */
        padding: 15px;
        background-color: rgb(228, 197, 157);
        border: 2px solid yellow;
        border-radius: 10px;
    }

    /* Chat header style */
    .chat-header {
        font-size: 18px; /* Increased for visibility */
        padding: 10px;
        background-color: rgb(16, 54, 221);
        color: white;
        text-align: center;
        border-radius: 10px;
    }

    /* Chat messages section adjustments for mobile */
    .chat-messages {
        height: 300px; /* Adjusted to fit screen */
        padding: 10px;
        overflow-y: auto;
        scrollbar-color: yellow;
        scrollbar-width: thin;
    }

    /* User message layout */
    .user-message {
        margin-left: 20%; /* Adjusted for mobile */
        font-size: 14px; /* Slightly larger font */
    }

    /* Bot message layout */
    .bot-message {
        margin-right: 20%; /* Adjusted for mobile */
        margin-top: 10px; /* Reduced spacing */
        font-size: 14px;
    }

    /* Input field styling for mobile */
    #message-input {
        width: 70%; /* Larger input field for typing */
        margin-left: 5%; /* Centered input */
        padding: 8px; /* Larger padding for easier touch interaction */
        font-size: 16px;
        border: 2px solid white;
        border-radius: 5px;
    }

    /* Send button adjustments for mobile */
    #send-button {
        width: 40px;
        height: 35px; /* Larger button for touch */
        font-size: 18px; /* Larger icon */
        margin-left: 5px; /* Closer to input */
        border: 2px solid #d3b894;
        border-radius: 5px;
        cursor: pointer;
    }
}

</style>

<script> 
    const chatMessages = document.getElementById('chat-messages');

    const messageInput = document.getElementById('message-input');

    const sendButton = document.getElementById('send-button');

    sendButton.addEventListener('click', sendMessage);

    function sendMessage() {

        const userMessage = messageInput.value;

        if (userMessage !== '') {

            displayMessage(userMessage, 'user');

            messageInput.value = '';
            ip = 

            fetch('/bot-response', {

                method: 'POST',

                headers: {

                    'Content-Type': 'application/json'

                },

                body: JSON.stringify(
                { message: userMessage }
                )
            })

            .then(response => response.json())

            .then(data => {

                displayMessage(data.response, 'bot');

            });

        }

    }

    function displayMessage(message, type) {

        const messageElement = document.createElement('div');

        messageElement.classList.add('message');

        if (type === 'user') {

            messageElement.classList.add('user-message');

        } else {

            messageElement.classList.add('bot-message');

        }

        messageElement.innerText = message;

        chatMessages.appendChild(messageElement);

        chatMessages.scrollTop = chatMessages.scrollHeight;

    }
</script>

{% endblock %}